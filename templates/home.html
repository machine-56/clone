{% extends 'base.html' %}
{% load static %}
{% block title %}Home | Connectly{% endblock %}
{% block content %}

<link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}">

<div class="main">
    <div class="heading text-center">
        <h2>
            Video calls and meetings for everyone
        </h2>
        <span id="sub_quotes">
            Where ideas meet and minds align
        </span>
    </div>

    <div class="meeting text-center">
        <button type="button" class="btn btn-outline-dark" data-bs-toggle="popover" data-bs-placement="bottom" data-for="meeting_options">
          Start a new meeting
        </button>
        <ul class="popover-menu list-unstyled d-none" data-for="meeting_options">
          <li id="meeting_instant" data-bs-toggle="modal" data-bs-target="#instantMeetingModal">
            <i class="fa-solid fa-plus"></i> Start an instant meeting
          </li>
          <li id="meeting_schedule" data-bs-toggle="modal" data-bs-target="#scheduleMeetingModal">
            <i class="fa-solid fa-clock"></i> Schedule a meeting for later
          </li>
        </ul>


        <button class="btn btn-outline-dark" data-bs-toggle="modal" data-bs-target="#joinMeetingModal">
          Join a new meeting
        </button>

    </div>
</div>


<!-- Join Meeting Modal -->
<div class="modal fade" id="joinMeetingModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-4">
      <form id="joinMeetingForm" method="post">
        {% csrf_token %}
        <div class="mb-3">
          <label for="meetingCode" class="form-label">Meeting Code</label>
          <input type="text" id="meetingCode" name="meeting_code" class="form-control border-0 border-bottom" required>
        </div>

        <div class="mb-3">
          <label for="meetingPassword" class="form-label">Password</label>
          <input type="password" id="meetingPassword" name="password" class="form-control border-0 border-bottom" required>
        </div>

        <div class="text-end">
          <button type="submit" id="" class="btn btn-outline-success">Join</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Stage 2: Video Preview & Join -->
<div class="modal fade" id="previewModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content p-4">
      <div class="row g-3">
        <!-- Video Preview -->
        <div class="col-12 col-lg-6">
          <div id="videoContainer" class="video-wrapper">
            <video id="videoPreview" autoplay playsinline muted></video>
            <div id="videoOffOverlay" class="d-none">Video Off</div>
          </div>
          <div class="mt-2 d-flex gap-2">
            <button id="toggleVideo" class="toggle-btn">
                <i class="fa-solid fa-video"></i>
            </button>
            <button id="toggleAudio" class="toggle-btn">
                <i class="fa-solid fa-microphone"></i>
            </button>
            <!-- Gear button -->
            <button id="openSettings" class="toggle-btn disabled">
              <i class="fa-solid fa-gear"></i>
            </button>
          </div>
        </div>

        <!-- Form -->
        <div class="col-12 col-lg-6">
          <form id="joinMeetingDetails">
            {% csrf_token %}
            <div class="mb-3">
              <label for="participantName" class="form-label">Name</label>
              <input type="text" id="participantName" name="name" class="form-control border-0 border-bottom" required>
            </div>

            <div class="mb-3">
              <label for="participantDesignation" class="form-label">Designation</label>
              <input type="text" id="participantDesignation" name="designation" class="form-control border-0 border-bottom" required>
            </div>

            <div class="text-end">
              <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-outline-success w-100">Join</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Device Settings Modal -->
<div class="modal fade" id="deviceSettingsModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-4">
      <h5 class="mb-3">Device Settings</h5>

      <!-- Video device selector -->
      <div class="mb-3">
        <label for="videoDeviceSelect" class="form-label">Camera</label>
        <select id="videoDeviceSelect" class="form-select"></select>
      </div>

      <!-- Audio device selector -->
      <div class="mb-3">
        <label for="audioDeviceSelect" class="form-label">Microphone</label>
        <select id="audioDeviceSelect" class="form-select"></select>
      </div>

      <div class="d-flex justify-content-end gap-2 mt-3">
        <button type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
        <button type="button" id="saveDeviceSettings" class="btn btn-outline-success">Save</button>
      </div>
    </div>
  </div>
</div>


<!-- Instant Meeting Modal -->
<div class="modal fade" id="instantMeetingModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Start an Instant Meeting</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="instantMeetingForm">
          <div class="mb-3">
            <label class="form-label">Name</label>
            <input type="text" id="instantName" class="form-control border-0 border-bottom" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Designation</label>
            <input type="text" id="instantDesignation" class="form-control border-0 border-bottom" required>
          </div>
          <button type="submit" class="btn btn-outline-success w-100">Start Meeting</button>
        </form>
      </div>
    </div>
  </div>
</div>



<!-- Meeting Credentials Modal -->
<div class="modal fade" id="meetingCredentialsModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content text-center">
      <div class="modal-header">
        <h5 class="modal-title">Meeting Credentials</h5>
      </div>
      <div class="modal-body">
        <div id="meeting_credentials" class="border rounded p-3 position-relative">
          <p class="mb-1">Your meeting code is: <span id="credCode"></span></p>
          <p class="mb-1">Your meeting password is: <span id="credPassword"></span></p>
          <button id="copyCredentials" class="btn btn-sm btn-outline-primary position-absolute bottom-0 end-0 m-2">
            <i class="fa-solid fa-copy"></i> Copy
          </button>
        </div>
      </div>
      <div class="modal-footer">
        <button id="understoodBtn" class="btn btn-warning w-100">I understood</button>
      </div>
    </div>
  </div>
</div>



<!-- Schedule Meeting Modal -->
<div class="modal fade" id="scheduleMeetingModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Schedule a Meeting</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form id="scheduleMeetingForm">
          <div class="mb-3">
            <label class="form-label">Name</label>
            <input type="text" id="scheduleName" class="form-control border-0 border-bottom" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Designation</label>
            <input type="text" id="scheduleDesignation" class="form-control border-0 border-bottom" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Time</label>
            <input type="time" id="scheduleTime" class="form-control border-0 border-bottom">
          </div>
          <button type="submit" class="btn btn-outline-success w-100">Schedule</button>
        </form>
      </div>
    </div>
  </div>
</div>



<!-- Overlay -->
<div id="transitionOverlay" class="transition-overlay d-flex align-items-center justify-content-center">
  <h2 class="text-white">Joining meetingâ€¦</h2>
</div>


<script src="{% static 'js/home.js' %}"></script>
{% endblock %}